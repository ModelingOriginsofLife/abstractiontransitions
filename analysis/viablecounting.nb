(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     11221,        287]
NotebookOptionsPosition[     10634,        265]
NotebookOutlinePosition[     10969,        280]
CellTagsIndexPosition[     10926,        277]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "1"}], "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "2"}], "]"}], "=", 
   RowBox[{
    SuperscriptBox["3", "n"], "-", 
    RowBox[{"2", "*", 
     SuperscriptBox["2", "n"]}], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Binomial", "[", 
       RowBox[{"n", ",", "i"}], "]"}], "*", 
      RowBox[{"f", "[", 
       RowBox[{"i", ",", 
        RowBox[{"d", "-", "1"}]}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          SuperscriptBox["2", 
           RowBox[{"d", "-", "1"}]], ")"}], 
         RowBox[{"n", "-", "i"}]], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"d", "-", "1"}]], "-", "1"}], ")"}], 
         RowBox[{"n", "-", "i"}]]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"n", ",", "d"}], "]"}], "/", 
    RowBox[{"d", "!"}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.624883408586701*^9, {3.624884086640526*^9, 3.6248840885295258`*^9}, {
   3.624886186567317*^9, 3.624886199482533*^9}, {3.624886281710052*^9, 
   3.624886287296274*^9}, {3.624886323239498*^9, 3.624886496356743*^9}, {
   3.624886645627985*^9, 3.624886684532445*^9}, {3.624886837893819*^9, 
   3.624886839579379*^9}, {3.624893957811534*^9, 3.6248939611239977`*^9}, {
   3.624894113103031*^9, 3.624894165546296*^9}, {3.624894247807742*^9, 
   3.624894255759728*^9}, {3.624895332793836*^9, 3.624895339895607*^9}, 
   3.624895505680574*^9, {3.6249869613471003`*^9, 3.624987035498603*^9}, {
   3.624987703356789*^9, 3.624987704976886*^9}, {3.6249877558325443`*^9, 
   3.6249877579022837`*^9}, {3.62498783615058*^9, 3.6249878363180637`*^9}, {
   3.625010814744771*^9, 3.625010815644786*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"s_", ",", "n_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n", ",", "d"}], "]"}], "*", 
   RowBox[{"Factorial", "[", "d", "]"}], "*", 
   RowBox[{"StirlingS2", "[", 
    RowBox[{"s", ",", "d"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"s_", ",", "n_", ",", "d_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"n", ",", "d"}], "]"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{"s", ",", "d"}], "]"}], "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "2"], "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"s", "-", "d"}], ")"}]]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.624886973912788*^9, 3.62488700903423*^9}, {
  3.6248870775915413`*^9, 3.624887128682006*^9}, {3.6250108325304117`*^9, 
  3.625010834819713*^9}, {3.625010880824458*^9, 3.625010885106345*^9}, {
  3.6250792276775017`*^9, 3.6250792472170153`*^9}, {3.625151003691639*^9, 
  3.6251510204565*^9}, {3.6253349460666018`*^9, 3.625334953329946*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"distcomp", "[", 
    RowBox[{"s_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"s", ",", "n", ",", "j"}], "]"}], "/", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"s", ",", "n", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"distcomp", "[", 
      RowBox[{"i", ",", "10"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "100"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6248939759027042`*^9, 3.624893979135425*^9}, {
   3.624894073833947*^9, 3.6248940895072727`*^9}, {3.625010861063571*^9, 
   3.625010894531015*^9}, {3.6250109594435863`*^9, 3.6250109780783253`*^9}, {
   3.62507925668583*^9, 3.6250792732995787`*^9}, {3.62507944597316*^9, 
   3.6250794912265787`*^9}, {3.625079713510775*^9, 3.625079791860731*^9}, {
   3.6250799491905947`*^9, 3.625079957779231*^9}, {3.625080120868804*^9, 
   3.625080157799197*^9}, {3.625080203830679*^9, 3.625080214424103*^9}, {
   3.6250805770942917`*^9, 3.62508057733875*^9}, {3.6250806490611343`*^9, 
   3.625080725288168*^9}, {3.625080770874888*^9, 3.625080803398014*^9}, {
   3.625145492343636*^9, 3.625145496155733*^9}, {3.625146284968883*^9, 
   3.625146289260169*^9}, {3.625146319365116*^9, 3.6251463307628717`*^9}, {
   3.625146407535013*^9, 3.6251464750332947`*^9}, {3.6251465178466*^9, 
   3.6251465196148443`*^9}, {3.62514664307668*^9, 3.625146655722239*^9}, {
   3.625146701490088*^9, 3.625146724638543*^9}, {3.6251518890018*^9, 
   3.625152071201606*^9}, {3.625152198587837*^9, 3.625152204184182*^9}, {
   3.625335291661482*^9, 3.6253353204687443`*^9}, {3.62533564811053*^9, 
   3.6253356760832977`*^9}, {3.625335741738957*^9, 3.625335743263341*^9}, 
   3.625335876989615*^9, {3.625335969555409*^9, 3.625336006537622*^9}, {
   3.6253361198951797`*^9, 3.625336132280918*^9}, {3.625336476525568*^9, 
   3.625336508650337*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"distcomp", "[", 
    RowBox[{"100", ",", "10"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"dd", "[", 
     RowBox[{"[", "100", "]"}], "]"}], ",", 
    RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
    RowBox[{"PlotMarkers", "\[Rule]", 
     RowBox[{"{", "Automatic", "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<d\>\"", ",", "\"\<p\>\""}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6250807387123003`*^9, 3.625080745482395*^9}, {
   3.625080783478848*^9, 3.625080785037953*^9}, {3.625080821739423*^9, 
   3.625080857618249*^9}, {3.625145516919744*^9, 3.625145622687015*^9}, {
   3.625146049220541*^9, 3.625146058387476*^9}, {3.625146346070982*^9, 
   3.6251463481979218`*^9}, 3.625146560391396*^9, {3.62514692364226*^9, 
   3.6251469469857693`*^9}, {3.625146995635858*^9, 3.625146995711977*^9}, {
   3.625147066972273*^9, 3.625147072979219*^9}, {3.625147127341395*^9, 
   3.625147131634088*^9}, {3.625151049558213*^9, 3.625151099922524*^9}, {
   3.625152074768261*^9, 3.625152075149127*^9}, {3.625159501781762*^9, 
   3.6251595542577887`*^9}, {3.62533637283947*^9, 3.625336396157957*^9}}],

Cell[BoxData[
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", "dd", "]"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<RedBlueTones\>\""}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.625335354112904*^9, 3.625335385801052*^9}, {
   3.625336445878063*^9, 3.625336445996099*^9}, {3.625336543072386*^9, 
   3.6253365475761003`*^9}, {3.625336585559896*^9, 3.6253365929736977`*^9}, {
   3.625336747419092*^9, 3.625336762134368*^9}, {3.625336877403389*^9, 
   3.625336881106545*^9}, {3.62533692531056*^9, 3.625336925591496*^9}, {
   3.625336978586276*^9, 3.6253369818311787`*^9}, 3.6253371721229563`*^9, 
   3.6253372053556967`*^9, {3.625337236472001*^9, 3.625337239962573*^9}, {
   3.625337282672964*^9, 3.625337284572233*^9}, {3.625337342511595*^9, 
   3.6253373476171513`*^9}, {3.625337405616742*^9, 3.6253374081630497`*^9}, {
   3.625337479848309*^9, 3.625337484072898*^9}, {3.625337547763154*^9, 
   3.625337563232047*^9}, {3.625337667464039*^9, 3.6253376978567753`*^9}, 
   3.6253377362247543`*^9, {3.625337845386683*^9, 3.6253379362391243`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxss", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"x", ",", 
           RowBox[{"Max", "[", "x", "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "dd"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.6251508123358994`*^9, {3.625151214271607*^9, 3.62515123503109*^9}, {
   3.62515136103358*^9, 3.625151380262083*^9}, {3.625151586567594*^9, 
   3.6251516081559563`*^9}, {3.625151642259737*^9, 3.625151662035262*^9}, {
   3.625152089063634*^9, 3.6251521661948433`*^9}, {3.625152298658703*^9, 
   3.625152332922949*^9}, 3.625336414396471*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"maxss", ",", 
    RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
    RowBox[{"PlotMarkers", "\[Rule]", 
     RowBox[{"{", "Automatic", "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Max", "[", "maxss", "]"}], "+", "0.2"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6251523350496273`*^9, 3.6251523356903753`*^9}, {
  3.625152396618539*^9, 3.6251524186938353`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "maxss"}]], "Input",
 CellChangeTimes->{{3.625159447748764*^9, 3.6251594495672293`*^9}}],

Cell[BoxData[
 RowBox[{"N", "[", "dd", "]"}]], "Input",
 CellChangeTimes->{{3.625339171771305*^9, 3.625339180022295*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.625335345136142*^9, 3.625335346101385*^9}}]
},
WindowSize->{1317, 744},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 2279, 61, 132, "Input"],
Cell[2839, 83, 1149, 30, 58, "Input"],
Cell[3991, 115, 2243, 46, 55, "Input"],
Cell[6237, 163, 1395, 28, 55, "Input"],
Cell[7635, 193, 1232, 20, 32, "Input"],
Cell[8870, 215, 807, 20, 32, "Input"],
Cell[9680, 237, 594, 15, 55, "Input"],
Cell[10277, 254, 134, 2, 55, "Input"],
Cell[10414, 258, 121, 2, 32, "Input"],
Cell[10538, 262, 92, 1, 32, "Input"]
}
]
*)

(* End of internal cache information *)
